<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
<meta name="google-site-verification" content="IpNgA5aPb7fAewOpvbq-eVkYwuCplcLKol7cG2itN5M" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <meta name="google-site-verification" content="google6993574491856c8e.html">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rebootcat.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":250,"display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"livere","storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言一直没有时间来整理下博客搭建的一些事情，现在补上一篇，给 Hexo Next 博客添加一个相册功能，使用瀑布流的方式。 原理说明 使用 github 作为仓库存储图片文件（图床） 使用 jsdelivr 进行图片 CDN 加速  优点此种方式的优点是免费，不需要购买其他的对象存储产品；并且使用的是 github 作为图床，图片不会丢失。  早期的博文使用的是七牛云的免费存储，结果后来被他们删掉">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo Next 博客添加相册瀑布流">
<meta property="og:url" content="https://rebootcat.com/2020/09/19/nextphotowall/index.html">
<meta property="og:site_name" content="林夕水共">
<meta property="og:description" content="前言一直没有时间来整理下博客搭建的一些事情，现在补上一篇，给 Hexo Next 博客添加一个相册功能，使用瀑布流的方式。 原理说明 使用 github 作为仓库存储图片文件（图床） 使用 jsdelivr 进行图片 CDN 加速  优点此种方式的优点是免费，不需要购买其他的对象存储产品；并且使用的是 github 作为图床，图片不会丢失。  早期的博文使用的是七牛云的免费存储，结果后来被他们删掉">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting_2/rebootcat/nextphotowall/1.png">
<meta property="article:published_time" content="2020-09-19T03:23:58.000Z">
<meta property="article:modified_time" content="2020-09-20T01:28:13.001Z">
<meta property="article:author" content="Smaug">
<meta property="article:tag" content="python">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="blog">
<meta property="article:tag" content="cdn">
<meta property="article:tag" content="github">
<meta property="article:tag" content="next">
<meta property="article:tag" content="jsdelivr">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting_2/rebootcat/nextphotowall/1.png">

<link rel="canonical" href="https://rebootcat.com/2020/09/19/nextphotowall/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Hexo Next 博客添加相册瀑布流 | 林夕水共</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="林夕水共" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">林夕水共</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">关于技术,关于生活</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook" rel="section"><i class="fa fa-fw fa-fas fa-comments"></i>留言</a>

  </li>
        <li class="menu-item menu-item-photos">

    <a href="/photos" rel="section"><i class="fa fa-fw fa-fas fa-camera-retro"></i>摄影</a>

  </li>
        <li class="menu-item menu-item-wiki">

    <a href="/wiki/" rel="section"><i class="fa fa-fw fa-wikipedia-w"></i>维基</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/smaugx" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://rebootcat.com/2020/09/19/nextphotowall/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/sidebar_wolf.png">
      <meta itemprop="name" content="Smaug">
      <meta itemprop="description" content="人至贱则无敌">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="林夕水共">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hexo Next 博客添加相册瀑布流
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-19 11:23:58" itemprop="dateCreated datePublished" datetime="2020-09-19T11:23:58+08:00">2020-09-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-20 09:28:13" itemprop="dateModified" datetime="2020-09-20T09:28:13+08:00">2020-09-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/19/nextphotowall/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/19/nextphotowall/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一直没有时间来整理下博客搭建的一些事情，现在补上一篇，给 Hexo Next 博客添加一个相册功能，使用瀑布流的方式。</p>
<h1 id="原理说明"><a href="#原理说明" class="headerlink" title="原理说明"></a>原理说明</h1><ul>
<li>使用 github 作为仓库存储图片文件（图床）</li>
<li>使用 jsdelivr 进行图片 CDN 加速</li>
</ul>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><p>此种方式的优点是免费，不需要购买其他的对象存储产品；并且使用的是 github 作为图床，图片不会丢失。</p>
<blockquote>
<p>早期的博文使用的是七牛云的免费存储，结果后来被他们删掉了。。。结果造成文中的一些图片链接都是 404，有兴趣的可以翻一翻我早期的博客。</p>
</blockquote>
<h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>由于采用的是 github 仓库存储图片，但是 github 对单仓库有 50MB 的大小限制，所以单仓库可能不能够存储太多的文件；</p>
<p>解决方法就是建立很多的图片仓库（稍微有点费劲，不过是行得通的）；另外上传的单张图片大小最好不要太大。</p>
<p>还有个缺点就是得折腾啊，且看我后文。</p>
<p>各位可以参考下我的相册瀑布流: <a href="https://rebootcat.com/photos/">摄影</a></p>
<h1 id="开始搭建相册瀑布流"><a href="#开始搭建相册瀑布流" class="headerlink" title="开始搭建相册瀑布流"></a>开始搭建相册瀑布流</h1><p>开始之前，需要简单介绍一下，我参考的是 <a href="https://blog.dlzhang.com/posts/31/" target="_blank" rel="noopener">Hexo NexT 博客增加瀑布流相册页面</a> 这篇文章，文中涉及到的脚本主要都是 js 实现；与他不同的是，由于我对 js 的掌握远远不及我对 Python 的掌握，故部分脚本我采用了 Python 实现。</p>
<p>所以在开始操作之前，你可以根据自己的技能，选择不同的方式。如果你擅长 python，那么跟着我来吧。</p>
<p><img src="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting_2/rebootcat/nextphotowall/1.png" alt=""></p>
<a id="more"></a>

<h2 id="新建-photo-页面"><a href="#新建-photo-页面" class="headerlink" title="新建 photo 页面"></a>新建 photo 页面</h2><p>去到博客根目录：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -<span class="keyword">p</span> <span class="keyword">source</span>/photos</span><br></pre></td></tr></table></figure>
<p>然后进入 photos 目录：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="keyword">source</span>/photos</span><br><span class="line"><span class="keyword">vim</span> <span class="built_in">index</span>.md</span><br></pre></td></tr></table></figure>
<p>把下面的粘贴保存：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 摄影</span><br><span class="line">type: photos</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- CSS Code --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.MyGrid</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;<span class="attribute">max-width</span>:<span class="number">1040px</span>;<span class="attribute">margin</span>:<span class="number">0</span> auto;<span class="attribute">text-align</span>:center&#125;<span class="selector-class">.card</span>&#123;<span class="attribute">overflow</span>:hidden;<span class="attribute">transition</span>:.<span class="number">3s</span> ease-in-out;<span class="attribute">border-radius</span>:<span class="number">8px</span>;<span class="attribute">background-color</span>:<span class="number">#efefef</span>;<span class="attribute">padding</span>:<span class="number">1.4px</span>&#125;<span class="selector-class">.ImageInCard</span> <span class="selector-tag">img</span>&#123;<span class="attribute">padding</span>:<span class="number">0</span>;<span class="attribute">border-radius</span>:<span class="number">8px</span>&#125;</span></span><br><span class="line">@media(prefers-color-scheme:dark)&#123;.card&#123;background-color:#333;&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- CSS Code End --&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"MyGrid"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="修改-Next-主题配置文件"><a href="#修改-Next-主题配置文件" class="headerlink" title="修改 Next 主题配置文件"></a>修改 Next 主题配置文件</h2><p>添加了 photos 页面后，需要在 next 配置文件中修改：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim themes/next/<span class="module-access"><span class="module"><span class="identifier">_config</span>.</span></span>yml</span><br></pre></td></tr></table></figure>
<p>找到 menu 项，填入如下：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">photos: /photos <span class="string">|| fas fa-camera-retro</span></span><br></pre></td></tr></table></figure>

<p>比如我的是这样的：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">menu:</span></span><br><span class="line"><span class="symbol">  home:</span> / || home</span><br><span class="line"><span class="symbol">  about:</span> <span class="meta-keyword">/about/</span> || user</span><br><span class="line"><span class="symbol">  tags:</span> <span class="meta-keyword">/tags/</span> || tags</span><br><span class="line"><span class="symbol">  categories:</span> <span class="meta-keyword">/categories/</span> || th</span><br><span class="line"><span class="symbol">  archives:</span> <span class="meta-keyword">/archives/</span> || archive</span><br><span class="line">  <span class="meta">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="meta">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="meta">#commonweal: /404/ || heartbeat</span></span><br><span class="line"><span class="symbol">  guestbook:</span> /guestbook || fas fa-comments</span><br><span class="line"><span class="symbol">  photos:</span> /photos || fas fa-camera-retro</span><br><span class="line"><span class="symbol">  wiki:</span> <span class="meta-keyword">/wiki/</span> || wikipedia-w</span><br></pre></td></tr></table></figure>

<p>完成之后还需要修改一下这个文件：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim themes/next/languages/zh-<span class="module-access"><span class="module"><span class="identifier">CN</span>.</span></span>yml</span><br></pre></td></tr></table></figure>
<p>找到 menu 项，加入如下一行：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">photos:</span> 摄影</span><br></pre></td></tr></table></figure>
<p>比如我的是这样的：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">首页</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">归档</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">分类</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">标签</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">关于</span></span><br><span class="line">  <span class="attr">search:</span> <span class="string">搜索</span></span><br><span class="line">  <span class="attr">schedule:</span> <span class="string">日程表</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">站点地图</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">公益</span> <span class="number">404</span></span><br><span class="line">  <span class="attr">guestbook:</span> <span class="string">留言</span></span><br><span class="line">  <span class="attr">photos:</span> <span class="string">摄影</span></span><br><span class="line">  <span class="attr">wiki:</span> <span class="string">维基</span></span><br></pre></td></tr></table></figure>

<p>OK，到这里应该能看到这个 <strong>摄影</strong> 页面了，你可以现在本地测试一下看：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo s -g</span></span><br></pre></td></tr></table></figure>

<h2 id="添加-js-脚本"><a href="#添加-js-脚本" class="headerlink" title="添加 js 脚本"></a>添加 js 脚本</h2><p>首先需要在 source 目录下新建一个 js 目录，用来保存自定义的一些 js 脚本；</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -<span class="keyword">p</span> <span class="keyword">source</span>/js</span><br></pre></td></tr></table></figure>
<p>然后新建 mygrid.js 文件，粘贴下面的一段代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取网页不含域名的路径</span></span><br><span class="line"><span class="keyword">var</span> windowPath = <span class="built_in">window</span>.location.pathname;</span><br><span class="line"><span class="comment">// 图片信息文件路径</span></span><br><span class="line"><span class="keyword">var</span> imgDataPath = <span class="string">'/photos/photoslist.json'</span>;</span><br><span class="line"><span class="comment">// 图片显示数量</span></span><br><span class="line"><span class="keyword">var</span> imgMaxNum = <span class="number">50</span>;</span><br><span class="line"><span class="comment">// 获取窗口宽度（以确定图片显示宽度）</span></span><br><span class="line"><span class="keyword">var</span> windowWidth = <span class="built_in">window</span>.innerWidth</span><br><span class="line">|| <span class="built_in">document</span>.documentElement.clientWidth</span><br><span class="line">|| <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line"><span class="keyword">if</span> (windowWidth &lt; <span class="number">768</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> imageWidth = <span class="number">145</span>; <span class="comment">// 图片显示宽度(手机)</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> imageWidth = <span class="number">215</span>; <span class="comment">// 图片显示宽度</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 腾讯云图片处理样式（根据图片显示宽度）</span></span><br><span class="line"><span class="keyword">var</span> imgStyle = <span class="string">'!'</span> + imageWidth + <span class="string">'x'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 图片卡片（照片页面）</span></span><br><span class="line"><span class="keyword">if</span> (windowPath.indexOf(<span class="string">'photos'</span>) &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">var</span> LinkDataPath = imgDataPath;</span><br><span class="line">    photo = &#123;</span><br><span class="line">        page: <span class="number">1</span>,</span><br><span class="line">        offset: imgMaxNum,</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">            $.getJSON(LinkDataPath, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                that.render(that.page, data);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        render: <span class="function"><span class="keyword">function</span> (<span class="params">page, data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> begin = (page - <span class="number">1</span>) * <span class="keyword">this</span>.offset;</span><br><span class="line">            <span class="keyword">var</span> end = page * <span class="keyword">this</span>.offset;</span><br><span class="line">            <span class="keyword">if</span> (begin &gt;= data.length) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">var</span> html, imgNameWithPattern, imgName, imageSize, imageX, imageY, li = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = begin; i &lt; end &amp;&amp; i &lt; data.length; i++) &#123;</span><br><span class="line">                imgNameWithPattern = data[i].split(<span class="string">';'</span>)[<span class="number">1</span>];  <span class="comment">// a.png</span></span><br><span class="line">                imgName = imgNameWithPattern.split(<span class="string">'.'</span>)[<span class="number">0</span>]  <span class="comment">// a</span></span><br><span class="line">                imageSize = data[i].split(<span class="string">';'</span>)[<span class="number">0</span>]; <span class="comment">// length.height</span></span><br><span class="line">                imageX = imageSize.split(<span class="string">'.'</span>)[<span class="number">0</span>]; <span class="comment">//  length</span></span><br><span class="line">                imageY = imageSize.split(<span class="string">'.'</span>)[<span class="number">1</span>]; <span class="comment">// height</span></span><br><span class="line"></span><br><span class="line">							  cdn_url       = data[i].split(<span class="string">';'</span>)[<span class="number">2</span>]; <span class="comment">// 原图 cdn url</span></span><br><span class="line">							  small_cdn_url = data[i].split(<span class="string">';'</span>)[<span class="number">3</span>]; <span class="comment">// 缩略图 cdn url</span></span><br><span class="line"></span><br><span class="line">                li += <span class="string">'&lt;div class="card" style="width:'</span> + imageWidth + <span class="string">'px" &gt;'</span> +</span><br><span class="line">                        <span class="string">'&lt;div class="ImageInCard" style="height:'</span>+ imageWidth * imageY / imageX + <span class="string">'px"&gt;'</span> +</span><br><span class="line">                            <span class="string">'&lt;a data-fancybox="gallery" href="'</span> + cdn_url + <span class="string">'" data-caption="'</span> + imgName + <span class="string">'" title="'</span> +  imgName + <span class="string">'"&gt;'</span> +</span><br><span class="line">                                <span class="string">'&lt;img data-src="'</span> + small_cdn_url + <span class="string">'" src="'</span> + small_cdn_url + <span class="string">'" data-loaded="true"&gt;'</span> +</span><br><span class="line">                            <span class="string">'&lt;/a&gt;'</span> +</span><br><span class="line">                        <span class="string">'&lt;/div&gt;'</span> +</span><br><span class="line">                      <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">            &#125;</span><br><span class="line">            $(<span class="string">".MyGrid"</span>).append(li);</span><br><span class="line">            <span class="keyword">this</span>.minigrid();</span><br><span class="line">        &#125;,</span><br><span class="line">        minigrid: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> grid = <span class="keyword">new</span> Minigrid(&#123;</span><br><span class="line">                container: <span class="string">'.MyGrid'</span>,</span><br><span class="line">                item: <span class="string">'.card'</span>,</span><br><span class="line">                gutter: <span class="number">12</span></span><br><span class="line">            &#125;);</span><br><span class="line">            grid.mount();</span><br><span class="line">            $(<span class="built_in">window</span>).resize(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                grid.mount();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    photo.init();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者你可以直接在我的博客上找到： <a href="https://rebootcat.com/js/mygrid.js">rebootcat.com/mygrid.js</a></p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://rebootcat<span class="number">.</span>com/<span class="keyword">js</span>/mygrid<span class="number">.</span><span class="keyword">js</span> -O source/<span class="keyword">js</span>/mygrid<span class="number">.</span><span class="keyword">js</span></span><br></pre></td></tr></table></figure>

<h2 id="新建图片信息文件"><a href="#新建图片信息文件" class="headerlink" title="新建图片信息文件"></a>新建图片信息文件</h2><p>我们再次回到 photos 目录，创建文件 photoslist.json：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="keyword">source</span><span class="regexp">/photos/</span>photoslist.json</span><br></pre></td></tr></table></figure>

<p>然后输入如下的内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  <span class="string">"1080.1920;WechatIMG114.jpeg;https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/photowall/cat/WechatIMG114.jpeg;https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/photowall/cat/WechatIMG114_small.jpeg"</span>,</span><br><span class="line">  <span class="string">"3024.4032;WechatIMG25834.jpeg;https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/photowall/cat/WechatIMG25834.jpeg;https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/photowall/cat/WechatIMG25834_small.jpeg"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>OK, 到现在应该你能从博客上看到这两张图片了:</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo s -g</span></span><br></pre></td></tr></table></figure>
<p>本地测试一下，如果你能看到在博客的 <strong>摄影</strong> 页面看到这两张图片，那么说明你的配置没问题，你可以进行接下来的操作了；如果你不能正确显示，说明前面的步骤出了问题，自己研究调试一下；如果你还不能解决，欢迎联系我。</p>
<h2 id="使用-python-脚本生成-photoslist-json"><a href="#使用-python-脚本生成-photoslist-json" class="headerlink" title="使用 python 脚本生成 photoslist.json"></a>使用 python 脚本生成 photoslist.json</h2><p>上面可以看到，<strong>photoslist.json 存放的是图片的信息，mygrid.js 解析 photoslist.json 这个文件，然后在 photos 页面添加 dom</strong>.</p>
<p>所以核心的部分在于 photoslist.json 文件，我们可以分析下这个文件：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1080.1920</span>;WechatIMG114.jpeg;https:<span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>smaugx<span class="regexp">/MyblogImgHosting/</span>rebootcat<span class="regexp">/photowall/</span>cat<span class="regexp">/WechatIMG114.jpeg;https:/</span><span class="regexp">/cdn.jsdelivr.net/g</span>h<span class="regexp">/smaugx/</span>MyblogImgHosting<span class="regexp">/rebootcat/</span>photowall<span class="regexp">/cat/</span>WechatIMG114_small.jpeg</span><br></pre></td></tr></table></figure>

<p>photoslist.json 保存的是一个 list，<strong>list 中每一行是一张图片的信息，包括原始图片大小、文件名、原始图片cdn链接、缩略图cdn链接</strong>。</p>
<p>前面已经提到，我们的图片是使用了 github 作为图床（仓库），然后使用 jsdelivr 进行 cdn 加速。所以我们应该准备好图片文件，然后上传到仓库。</p>
<h3 id="新建-github-仓库，用来存放图片文件"><a href="#新建-github-仓库，用来存放图片文件" class="headerlink" title="新建 github 仓库，用来存放图片文件"></a>新建 github 仓库，用来存放图片文件</h3><p>在 <a href="https://github.com" target="_blank" rel="noopener">https://github.com</a> 上创建图片仓库。</p>
<blockquote>
<p>当仓库容量超过 50MB 之后需要重新再新建一个仓库</p>
</blockquote>
<p>本地克隆仓库，然后把图片放入仓库，上传(这里以我的仓库为例）</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">git</span>@github.com:smaugx/MyblogImgHosting_2.git blogimg_2</span><br><span class="line">cd blogimg_2</span><br><span class="line"></span><br><span class="line"><span class="comment"># put some image in this dir</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<h3 id="生成-photoslist-json-文件"><a href="#生成-photoslist-json-文件" class="headerlink" title="生成 photoslist.json 文件"></a>生成 photoslist.json 文件</h3><p>编写 python 脚本或者直接从我的网站下载：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http<span class="variable">s:</span>//rebootcat.<span class="keyword">com</span>/js/phototool.<span class="keyword">py</span>  -O phototool.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf8  -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ExifTags</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">        <span class="comment"># github 存储图片的仓库（本地仓库基准目录）</span></span><br><span class="line">        <span class="string">'github_img_host_base'</span>: <span class="string">'/Users/smaug/blogimg_2'</span>,</span><br><span class="line">        <span class="comment"># 会对这个目录下的所有文件夹进行遍历，相同目录生成_samll 的 缩略图</span></span><br><span class="line">        <span class="string">'img_path'</span>:             <span class="string">'/Users/smaug/blogimg_2/rebootcat/photowall'</span>,</span><br><span class="line">        <span class="comment"># cdn 前缀</span></span><br><span class="line">        <span class="string">'cdn_url_prefix'</span>:       <span class="string">'https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting_2'</span>,</span><br><span class="line">        <span class="comment"># hexo 博客存放 photos 信息的 json 文件</span></span><br><span class="line">        <span class="string">'photo_info_json'</span>:      <span class="string">'/Users/smaug/blog_rebootcat/source/photos/photoslist.json'</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩图片到 90%(目的是为了移除一些gps 等信息，并非真的为了压缩）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compress_img</span><span class="params">(img_path, rate = <span class="number">0.99</span>, override = False)</span>:</span></span><br><span class="line">    support_ftype_list = [<span class="string">'png'</span>, <span class="string">'PNG'</span>, <span class="string">'jpeg'</span>, <span class="string">'JPEG'</span>, <span class="string">'gif'</span>, <span class="string">'GIF'</span>, <span class="string">'bmp'</span>]</span><br><span class="line">    sp_img = img_path.split(<span class="string">'.'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> sp_img <span class="keyword">or</span> sp_img[<span class="number">-1</span>] <span class="keyword">not</span> <span class="keyword">in</span> support_ftype_list:</span><br><span class="line">        print(<span class="string">"not support image type:&#123;0&#125;"</span>, img_path)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    sp_img = img_path.split(<span class="string">'/'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> sp_img:</span><br><span class="line">        print(<span class="string">"please give the right image path:&#123;0&#125;"</span>, img_path)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    img_full_name = sp_img[<span class="number">-1</span>]</span><br><span class="line">    img_name = img_full_name.split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">    img_type = img_full_name.split(<span class="string">'.'</span>)[<span class="number">1</span>]</span><br><span class="line">    img_path_prefix = img_path[:-len(img_full_name)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 覆盖原图或者另存为</span></span><br><span class="line">    compress_img_path = <span class="string">''</span></span><br><span class="line">    <span class="keyword">if</span> override:</span><br><span class="line">        compress_img_path = img_path</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        compress_img_path = <span class="string">'&#123;0&#125;&#123;1&#125;_com.&#123;2&#125;'</span>.format(img_path_prefix, img_name, img_type)</span><br><span class="line"></span><br><span class="line">    img = Image.open(img_path)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> orientation <span class="keyword">in</span> ExifTags.TAGS.keys() :</span><br><span class="line">            <span class="keyword">if</span> ExifTags.TAGS[orientation]==<span class="string">'Orientation'</span> : <span class="keyword">break</span></span><br><span class="line">        exif=dict(img._getexif().items())</span><br><span class="line">        <span class="keyword">if</span>   exif[orientation] == <span class="number">3</span> :</span><br><span class="line">            img=img.rotate(<span class="number">180</span>, expand = <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">elif</span> exif[orientation] == <span class="number">6</span> :</span><br><span class="line">            img=img.rotate(<span class="number">270</span>, expand = <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">elif</span> exif[orientation] == <span class="number">8</span> :</span><br><span class="line">            img=img.rotate(<span class="number">90</span>, expand = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"catch exception:&#123;0&#125;"</span>,e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        original_size = img.size</span><br><span class="line">        length = original_size[<span class="number">0</span>]</span><br><span class="line">        height = original_size[<span class="number">1</span>]</span><br><span class="line">        new_length = int(length * rate)</span><br><span class="line">        new_height = int(height * rate)</span><br><span class="line">        print(<span class="string">"originla length:&#123;0&#125; height:&#123;1&#125;"</span>, length, height)</span><br><span class="line">        print(<span class="string">"after compress length:&#123;0&#125; height:&#123;1&#125;"</span>, new_length, new_height)</span><br><span class="line">        img = img.resize((new_length, new_height), Image.ANTIALIAS)</span><br><span class="line">        img.save(compress_img_path, img_type)</span><br><span class="line">        print(<span class="string">"save compress img &#123;0&#125;"</span>.format(compress_img_path))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"catch exception:&#123;0&#125;"</span>,e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对 img_path 目录下的文件夹递归生成缩略图保存到同目录下</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thumbnail_pic</span><span class="params">(github_img_host_base, img_path, cdn_url_prefix)</span>:</span></span><br><span class="line">    <span class="comment"># 删除最后一个 '/'</span></span><br><span class="line">    <span class="keyword">if</span> img_path[<span class="number">-1</span>] == <span class="string">'/'</span>:</span><br><span class="line">        img_path = img_path[:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">if</span> github_img_host_base[<span class="number">-1</span>] == <span class="string">'/'</span>:</span><br><span class="line">        github_img_host_base = github_img_host_base[:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">if</span> cdn_url_prefix[<span class="number">-1</span>] == <span class="string">'/'</span>:</span><br><span class="line">        cdn_url_prefix = cdn_url_prefix[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    photo_info_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> os.listdir(img_path):</span><br><span class="line">        print(item)</span><br><span class="line">        abs_item = os.path.join(img_path, item)</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(abs_item): <span class="comment"># sub-dir</span></span><br><span class="line">            sub_img_path = abs_item</span><br><span class="line">            print(<span class="string">"cd dir:&#123;0&#125;"</span>.format(sub_img_path))</span><br><span class="line">            sub_photo_info_list = thumbnail_pic(github_img_host_base, sub_img_path, cdn_url_prefix)</span><br><span class="line">            photo_info_list.extend(sub_photo_info_list)</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># file</span></span><br><span class="line">            ftype = item.split(<span class="string">'.'</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> ftype <span class="keyword">or</span> len(ftype) != <span class="number">2</span>:</span><br><span class="line">                print(<span class="string">"error: invalid file:&#123;0&#125;"</span>.format(item))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            fname = ftype[<span class="number">0</span>]  <span class="comment"># a.png -&gt; a</span></span><br><span class="line">            ftype = ftype[<span class="number">1</span>]  <span class="comment"># a.png -&gt; png</span></span><br><span class="line">            support_ftype_list = [<span class="string">'png'</span>, <span class="string">'PNG'</span>, <span class="string">'jpeg'</span>, <span class="string">'JPEG'</span>, <span class="string">'gif'</span>, <span class="string">'GIF'</span>, <span class="string">'bmp'</span>]</span><br><span class="line">            <span class="keyword">if</span> ftype <span class="keyword">not</span> <span class="keyword">in</span> support_ftype_list:</span><br><span class="line">                print(<span class="string">"error: file type &#123;0&#125; not support, only support &#123;1&#125;"</span>.format(ftype, json.dumps(support_ftype_list)))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            abs_file = abs_item</span><br><span class="line">            <span class="keyword">if</span> item.find(<span class="string">'_small'</span>) != <span class="number">-1</span>: <span class="comment"># 这是缩略图</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            small_file = <span class="string">'&#123;0&#125;_small.&#123;1&#125;'</span>.format(fname, ftype)</span><br><span class="line">            abs_small_file = os.path.join(img_path, small_file)  <span class="comment"># 缩略图绝对路径</span></span><br><span class="line">            <span class="keyword">if</span> os.path.exists(abs_small_file):</span><br><span class="line">                <span class="comment"># 对应的 _small 缩略图已经存在</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            compress_status = compress_img(abs_file, <span class="number">0.9</span>, <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> compress_status:</span><br><span class="line">                print(<span class="string">"compress_img fail:&#123;0&#125;"</span>, abs_file)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            im = Image.open(abs_file)</span><br><span class="line">            original_size = im.size</span><br><span class="line">            length = original_size[<span class="number">0</span>]</span><br><span class="line">            height = original_size[<span class="number">1</span>]</span><br><span class="line">            m = int(float(length) / <span class="number">200.0</span>)  <span class="comment"># 计算缩小比例 (缩略图限制 200 长度)</span></span><br><span class="line">            new_length = int(float(length) / m)</span><br><span class="line">            new_height = int(float(height) / m)</span><br><span class="line">            im.thumbnail((new_length, new_height))  <span class="comment"># 生成缩略图</span></span><br><span class="line">            im.save(abs_small_file, ftype)  <span class="comment"># 保存缩略图</span></span><br><span class="line">            print(<span class="string">"save thumbnail img &#123;0&#125;"</span>.format(abs_small_file))</span><br><span class="line"></span><br><span class="line">            relative_file       = abs_file[len(github_img_host_base) + <span class="number">1</span>:] <span class="comment"># 计算相对路径，用来拼接 cdn</span></span><br><span class="line">            relative_small_file = abs_small_file[len(github_img_host_base) + <span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">            cdn_url_file        = <span class="string">'&#123;0&#125;/&#123;1&#125;'</span>.format(cdn_url_prefix, relative_file)</span><br><span class="line">            cdn_url_small_file  = <span class="string">'&#123;0&#125;/&#123;1&#125;'</span>.format(cdn_url_prefix, relative_small_file)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 格式: 690.690;8.png;http://cdn_file_url;http://cdn_small_file_url;</span></span><br><span class="line">            line = <span class="string">'&#123;0&#125;.&#123;1&#125;;&#123;2&#125;;&#123;3&#125;;&#123;4&#125;'</span>.format(length, height, item, cdn_url_file, cdn_url_small_file)</span><br><span class="line">            photo_info_list.append(line)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># end for loop</span></span><br><span class="line">    print(<span class="string">'dir:&#123;0&#125; Done!'</span>.format(img_path))</span><br><span class="line">    <span class="keyword">return</span> photo_info_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    github_img_host_base = config.get(<span class="string">'github_img_host_base'</span>)</span><br><span class="line">    img_path             = config.get(<span class="string">'img_path'</span>)</span><br><span class="line">    cdn_url_prefix       = config.get(<span class="string">'cdn_url_prefix'</span>)</span><br><span class="line">    photo_info_json      = config.get(<span class="string">'photo_info_json'</span>)</span><br><span class="line"></span><br><span class="line">    photo_info_list     = []</span><br><span class="line">    photo_info_list_has = []</span><br><span class="line">    photo_info_list = thumbnail_pic(github_img_host_base, img_path, cdn_url_prefix)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(photo_info_json):</span><br><span class="line">        <span class="keyword">with</span> open(photo_info_json, <span class="string">'r'</span>) <span class="keyword">as</span> fin:</span><br><span class="line">            photo_info_list_has = json.loads(fin.read())</span><br><span class="line">            fin.close()</span><br><span class="line"></span><br><span class="line">    photo_info_list_has.extend(photo_info_list)  <span class="comment"># 追加此次新增的 photo info</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(photo_info_json, <span class="string">'w'</span>) <span class="keyword">as</span> fout:</span><br><span class="line">        fout.write(json.dumps(photo_info_list_has, indent = <span class="number">2</span>))</span><br><span class="line">        print(<span class="string">"save photo_info_list to &#123;0&#125;"</span>.format(photo_info_json))</span><br><span class="line">        fout.close()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\nAll Done"</span>)</span><br></pre></td></tr></table></figure>

<p>这里重点需要关注的是：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">config = &#123;</span><br><span class="line">        <span class="meta"># github 存储图片的仓库（本地仓库基准目录）</span></span><br><span class="line">        'github_img_host_base': '/Users/smaug/blogimg_2',</span><br><span class="line">        <span class="meta"># 会对这个目录下的所有文件夹进行遍历，相同目录生成_samll 的 缩略图</span></span><br><span class="line">        'img_path':             '/Users/smaug/blogimg_2/rebootcat/photowall',</span><br><span class="line">        <span class="meta"># cdn 前缀</span></span><br><span class="line">        'cdn_url_prefix':       'https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting_2',</span><br><span class="line">        <span class="meta"># hexo 博客存放 photos 信息的 json 文件</span></span><br><span class="line">        'photo_info_json':      '/Users/smaug/blog_rebootcat/source/photos/photoslist.json',</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>简单解释一下这个脚本：</p>
<ul>
<li>github_img_host_base： 这个目录也就是本地的仓库目录，绝对路径（上面克隆的仓库对应的本地文件夹路径）</li>
<li>img_path: 我单独新建了 rebootcat/photowall 目录存放瀑布流图片，对应本地的路径</li>
<li>cdn_url_prefix：jsdelivr cdn url 前缀，只需要更改成你自己的github 用户名以及仓库名</li>
<li>photo_info_json： photoslist.json 路径</li>
</ul>
<p>上面几个参数一定要配置对了。</p>
<p>那么简单解释一下脚本的功能：</p>
<p><strong>脚本会递归的查找 img_path 目录下的图片，然后进行一定的压缩（99%），这里的压缩目的并非真的是压缩，而是为了去除一些敏感信息，比如 GPS 信息。注意这里会覆盖掉原始图片。然后会生成图片的缩略图，同时根据上面的几个配置参数，生成两个 cdn url，一个对应的是原始图片的 cdn url，一个是缩略图的 cdn url</strong>.</p>
<p>然后执行：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> phototool.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
<p>脚本执行完，就会<strong>增量生成</strong> photoslist.json，可以先打开检查下对不对，或者把里面的 cdn url 复制出来从浏览器看能不能访问。</p>
<blockquote>
<p><strong>注意需要把本地图片仓库推送到远程</strong>。</p>
</blockquote>
<p>这个 phototool.py 脚本你可以随便放在哪里，当你更新图片之后重新执行一遍就可以了。当然你也可以像我一样，跟网站源码直接放一起，所以你可以看到，我直接放到了 js 目录。</p>
<h2 id="更新图片"><a href="#更新图片" class="headerlink" title="更新图片"></a>更新图片</h2><p>把新图片放到本地仓库，然后执行：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> phototool.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>

<p>检查一下 photoslist.json 文件对不对，然后发布博客：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo d -g</span></span><br></pre></td></tr></table></figure>

<p>发布之后，记得把本地图片仓库推送到远端，不然 jsdelivr 无法访问到。</p>
<p>至此，一个相册瀑布流就制作完成了！</p>
<h1 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h1><p>由于我是采用回忆的方式来写的博文，所以文中可能会有一些小的修改或者配置我忽略了，不过问题不大，大家如果碰到问题了可以自行研究一下，能解决的。</p>
<p>采用 github 作为图床来存放大量的瀑布流图片墙，方案是没问题的，只不过可能由于仓库容量的限制，需要在 github 上构建多个图片仓库。</p>
<p>对于我来说，github 图片仓库主要用来存放博文中涉及到的图片。至于图片墙，我再另想办法吧。</p>
<p>Blog:</p>
<ul>
<li><p><a href="http://rebootcat.com">rebootcat.com</a></p>
</li>
<li><p>email: <a href="mailto:&#108;&#x69;&#110;&#117;&#x78;&#99;&#111;&#x64;&#x65;&#x32;&#x6e;&#x69;&#x6b;&#105;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#108;&#x69;&#110;&#117;&#x78;&#99;&#111;&#x64;&#x65;&#x32;&#x6e;&#x69;&#x6b;&#105;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></p>
</li>
</ul>
<p>2020-09-19 于杭州<br><em>By  <a href="https://github.com/smaugx" target="_blank" rel="noopener">史矛革</a></em></p>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2016/06/10/我的个人博客搭建记录/" rel="bookmark">我的个人博客搭建记录</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/09/20/cloudflare/" rel="bookmark">Hexo 配置 Cloudflare 免费 CDN</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/11/10/move_blog_hk/" rel="bookmark">博客大事记之迁移博客到香港主机</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/09/20/wiki/" rel="bookmark">使用 mkdocs 搭建个人 wiki 站点</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/02/13/new_picture_bed_github/" rel="bookmark">博客图床切换 Github + jsDelivr + PicGo</a></div>
    </li>
  </ul>

        <div class="reward-container">
  <div>buy me a cola!</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/wechat_pay.png" alt="Smaug 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Smaug
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://rebootcat.com/2020/09/19/nextphotowall/" title="Hexo Next 博客添加相册瀑布流">https://rebootcat.com/2020/09/19/nextphotowall/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://github.com/smaugx">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>

            <span class="label">Github</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/hexo/" rel="tag"># hexo</a>
              <a href="/tags/blog/" rel="tag"># blog</a>
              <a href="/tags/cdn/" rel="tag"># cdn</a>
              <a href="/tags/github/" rel="tag"># github</a>
              <a href="/tags/next/" rel="tag"># next</a>
              <a href="/tags/jsdelivr/" rel="tag"># jsdelivr</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/09/16/think_about_blockchain/" rel="prev" title="对区块链行业现状的一点看法">
      <i class="fa fa-chevron-left"></i> 对区块链行业现状的一点看法
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/09/20/virtual_space_blog/" rel="next" title="迁移博客到香港虚拟空间">
      迁移博客到香港虚拟空间 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#原理说明"><span class="nav-number">2.</span> <span class="nav-text">原理说明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#优点"><span class="nav-number">2.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#缺点"><span class="nav-number">2.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#开始搭建相册瀑布流"><span class="nav-number">3.</span> <span class="nav-text">开始搭建相册瀑布流</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#新建-photo-页面"><span class="nav-number">3.1.</span> <span class="nav-text">新建 photo 页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改-Next-主题配置文件"><span class="nav-number">3.2.</span> <span class="nav-text">修改 Next 主题配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加-js-脚本"><span class="nav-number">3.3.</span> <span class="nav-text">添加 js 脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#新建图片信息文件"><span class="nav-number">3.4.</span> <span class="nav-text">新建图片信息文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-python-脚本生成-photoslist-json"><span class="nav-number">3.5.</span> <span class="nav-text">使用 python 脚本生成 photoslist.json</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#新建-github-仓库，用来存放图片文件"><span class="nav-number">3.5.1.</span> <span class="nav-text">新建 github 仓库，用来存放图片文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生成-photoslist-json-文件"><span class="nav-number">3.5.2.</span> <span class="nav-text">生成 photoslist.json 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更新图片"><span class="nav-number">3.6.</span> <span class="nav-text">更新图片</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-End"><span class="nav-number">4.</span> <span class="nav-text">The End</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Smaug"
      src="https://cdn.jsdelivr.net/gh/smaugx/MyblogImgHosting/rebootcat/sidebar_wolf.png">
  <p class="site-author-name" itemprop="name">Smaug</p>
  <div class="site-description" itemprop="description">人至贱则无敌</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">62</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">154</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/smaugx" title="Github → https:&#x2F;&#x2F;github.com&#x2F;smaugx" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>Github</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://子不语.site/" title="https:&#x2F;&#x2F;子不语.site&#x2F;" rel="noopener" target="_blank">子不语</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Smaug</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>

  <span class="post-meta-divider">|</span>
	<span class="smaug_cnzz">
	<script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1279285424'%3E%3C/span%3E%3Cscript src='https://s9.cnzz.com/z_stat.php%3Fid%3D1279285424' type='text/javascript'%3E%3C/script%3E"));</script>
	</span>

</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'd5vhXhrHKkiBVVpR1WJJLgQP-gzGzoHsz',
      appKey     : 'BRzIFYxjcm34z68pyNalDPtw',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>





    <script type="text/javascript">
        if(window.location.hash){
            var checkExist = setInterval(function() {
                if ($(window.location.hash).length) {
                    $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
                    clearInterval(checkExist);
                }
            }, 100);
        }
    </script>


</body>
</html>
